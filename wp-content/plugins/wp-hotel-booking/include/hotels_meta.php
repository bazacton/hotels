<?php/** *  File Type: Hotels Class */if( ! class_exists('cs_hotels_options') ) {	    class cs_hotels_options {				public function __construct() {			add_action('wp_ajax_cs_add_hotels', array(&$this, 'cs_add_hotels'));			add_action('wp_ajax_cs_remove_hotels', array(&$this, 'cs_remove_hotels'));			add_action( 'admin_menu', array(&$this, 'cs_hotel_settings') );		}				//add submenu page		public function cs_hotel_settings() {						add_submenu_page('edit.php?post_type=rooms', __('Hotels', 'booking'), __('Hotels', 'booking'), 'manage_options', 'cs_hotels', array(&$this, 'list_hotels'));		}						public function list_hotels( ) {			global $cs_plugin_options;						$currency_sign = isset($cs_plugin_options['currency_sign']) ? $cs_plugin_options['currency_sign'] : '$';						wp_hotel_booking::cs_data_table_style_script();						$cs_hotel_data = get_option( "cs_hotel_options" );						$cs_html = '			<div class="theme-wrap fullwidth">				<div class="row">				 <div id="message" class="cs-update-message updated notice notice-success" style="display:none;">                        <p></p>                    </div>					<form name="cs-booking-customers" id="cs-booking-customers" data-url="'.esc_js(admin_url('admin-ajax.php')).'" method="post">						<div class="cs-customers-area">							<script type="text/javascript">							jQuery(document).ready(function() {								jQuery("#cs_hotels_data").DataTable({									fnDrawCallback : function() {										cs_delete_hotel();								  	}								});								cs_delete_hotel();							});							</script>							<div class="cs-title"><h2>' . __('Manage Hotels', 'booking') . '</h2></div>	                        <a href="javascript:cs_createpop(\'cs_hotel_pop\',\'filter\')" style="margin-top:20px;" class="button">'.__("+ Add New Hotel","booking").'</a>							<div class="cs_table_data cs_loading">								<table id="cs_hotels_data" class="display" cellspacing="0" width="100%">									<thead>										<tr>											<th>'.__('Hotel Name','booking').'</th>											<th>'.__('Country','booking').'</th>											<th>'.__('Booking Email','booking').'</th>											<th>'.__('Stars','booking').'</th>											<th>'.__('Phone','booking').'</th>											<th>'.__('Action','booking').'</th>										</tr>									</thead>									<tfoot>										<tr>											<th>'.__('Hotel Name','booking').'</th>											<th>'.__('Country','booking').'</th>											<th>'.__('Booking Email','booking').'</th>											<th>'.__('Stars','booking').'</th>											<th>'.__('Phone','booking').'</th>											<th>'.__('Action','booking').'</th>										</tr>									</tfoot>									<tbody>';										$cs_hotel_counter = 0;										if( isset( $cs_hotel_data ) && is_array( $cs_hotel_data) && sizeof( $cs_hotel_data ) > 0 ) {											foreach( $cs_hotel_data as $key => $hotel ) {																																			if( isset($cs_hotel_data[$key]) ) {													$cs_hotel_fields = $cs_hotel_data[$key];												}																								if( isset($cs_hotel_fields) ) {													$cs_hotel_name 			= isset($cs_hotel_fields['cs_hotel_name']) ? $cs_hotel_fields['cs_hotel_name'] : '';													$cs_hotel_name 			= isset($cs_hotel_fields['cs_hotel_name']) ? $cs_hotel_fields['cs_hotel_name'] : '';													$cs_hotel_country 		= isset($cs_hotel_fields['cs_hotel_country']) ? $cs_hotel_fields['cs_hotel_country'] : '';													$cs_hotel_booking_email = isset($cs_hotel_fields['cs_hotel_booking_email']) ? $cs_hotel_fields['cs_hotel_booking_email'] : '';													$cs_hotel_stars 		= isset($cs_hotel_fields['cs_hotel_stars']) ? $cs_hotel_fields['cs_hotel_stars'] : '';													$cs_hotel_phone 		= isset($cs_hotel_fields['cs_hotel_phone']) ? $cs_hotel_fields['cs_hotel_phone'] : '';																										$cs_html .= '<tr class="hotel-detail">																	<td>'.$cs_hotel_name.'</td>																	<td>'.$cs_hotel_country.'</td>																	<td>'.$cs_hotel_booking_email.'</td>																	<td>'.$cs_hotel_stars.'</td>																	<td>'.$cs_hotel_phone.'</td>																	<td class="hotel-action" data-key='.$key.'>																		<a class="hotel-delete"><i class="icon-trash4"></i></a>																																				<a href="javascript:cs_createpop(\'cs_hotel_pop_'.$cs_hotel_counter.'\',\'filter\')"><i class="icon-pencil3"></i></a>																		'.$this->cs_hotel_edit($key,$cs_hotel_counter).'																	</td>																</tr>';																												}else {													$cs_html .= '<tr><td class="dataTables_empty" valign="top" colspan="7">' . __('No records found.', 'booking') . '</td></tr>';												}												$cs_hotel_counter++;											}										}									$cs_html .= '										</tbody>								</table>							</div>						</div>					</form>				</div>			</div>';			echo force_balance_tags( $cs_html, true );			echo $this->cs_hotel_form();		}				/**		 *		 *@Edit Hotel		 *		 */		public function cs_hotel_edit( $key='',$counter='' ){			global $post;			$cs_hotel_data = get_option( "cs_hotel_options" );			$hotel_data	= $cs_hotel_data[$key];			$cs_html  = '';			$cs_html .= '<div class="cs-rooms-prices cs-hotels-area cs-hotels-edit"><div id="cs_hotel_pop_'.$counter.'" style="display: none;">							<div class="cs-popup-header">								<h5 style="margin:0px">' . __('Edit Hotel', 'booking') . '</h5>								<span class="cs-pop-close" onclick="javascript:cs_remove_overlay(\'cs_hotel_pop_'.$counter.'\',\'append\')"> <i class="icon-times"></i></span>							</div>							<div class="cs-popup-content">							 <div class="message-wrap" style="display:none">								<div class="cs-message updated"></div>							</div>';								$cs_html .= '								<div class="hotel-input">								<label>									<span>'.__('Hotel Name','booking').'</span>									<input id="cs_hotel_name" value="'.$hotel_data['cs_hotel_name'].'" name="cs_hotel_name" type="text" />								</label>								<label>									<span>'.__('Street address','booking').'</span>									<input id="cs_hotel_street_adres" value="'.$hotel_data['cs_hotel_street_adres'].'" name="cs_hotel_street_adres" type="text" />								</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('City','booking').'</span>										<input id="cs_hotel_city" value="'.$hotel_data['cs_hotel_city'].'" name="cs_hotel_city" type="text" />									</label>									<label>										<span>'.__('State','booking').'</span>										<input id="cs_hotel_state" value="'.$hotel_data['cs_hotel_state'].'" name="cs_hotel_state" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Country','booking').'</span>										<input id="cs_hotel_country" value="'.$hotel_data['cs_hotel_country'].'" name="cs_hotel_country" type="text" />									</label>									<label>										<span>'.__('ZIP/Postal Code','booking').'</span>										<input id="cs_hotel_postal" value="'.$hotel_data['cs_hotel_postal'].'" name="cs_hotel_postal" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Phone #','booking').'</span>										<input id="cs_hotel_phone" value="'.$hotel_data['cs_hotel_phone'].'" name="cs_hotel_phone" type="text" />									</label>									<label>										<span>'.__('Fax','booking').'</span>										<input id="cs_hotel_fax" value="'.$hotel_data['cs_hotel_fax'].'" name="cs_hotel_fax" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Email','booking').'</span>										<input id="cs_hotel_email" value="'.$hotel_data['cs_hotel_email'].'" name="cs_hotel_email" type="text" />									</label>									<label>										<span>'.__('Stars','booking').'</span>										<input id="cs_hotel_stars" value="'.$hotel_data['cs_hotel_stars'].'" name="cs_hotel_stars" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Map','booking').'</span>										<input id="cs_hotel_maps" value="'.$hotel_data['cs_hotel_maps'].'" name="cs_hotel_maps" type="text" />									</label>									<label>										<span>'.__('Booking Email','booking').'</span>										<input id="cs_hotel_booking_email" value="'.$hotel_data['cs_hotel_booking_email'].'" name="cs_hotel_booking_email" type="text" />										<p>This email use in notification for Booking</p>									</label>								</div>								<div id="add_hotel_to_btn">									<a class="hotel-action-btn price-btn" id="cs_edit_hotel" data-key="update" data-id="'.$key.'" type="button">'.__('Update Hotel', 'booking').'</a>								</div>							</div>							</div>						</div>';			return force_balance_tags( $cs_html, true );		}				/**		 *		 *@Add Form		 *		 */		public function cs_hotel_form(){			global $post;			$cs_html  = '';			$cs_html .= '<div class="cs-rooms-prices cs-hotels-area"><div id="cs_hotel_pop" style="display: none;">							<div class="cs-popup-header">								<h5 style="margin:0px">' . __('Add New Hotel', 'booking') . '</h5>								<span class="cs-pop-close" onclick="javascript:cs_remove_overlay(\'cs_hotel_pop\',\'append\')"> <i class="icon-times"></i></span>							</div>							<div class="cs-popup-content">							 <div class="message-wrap" style="display:none">								<div class="cs-message updated"></div>							</div>';								$cs_html .= '								<div class="hotel-input">								<label>									<span>'.__('Hotel Name','booking').'  *(required)</span>									<input id="cs_hotel_name" name="cs_hotel_name" type="text" />								</label>								<label>									<span>'.__('Street address','booking').'</span>									<input id="cs_hotel_street_adres" name="cs_hotel_street_adres" type="text" />								</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('City','booking').'</span>										<input id="cs_hotel_city" name="cs_hotel_city" type="text" />									</label>									<label>										<span>'.__('State','booking').'</span>										<input id="cs_hotel_state" name="cs_hotel_state" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Country','booking').'</span>										<input id="cs_hotel_country" name="cs_hotel_country" type="text" />									</label>									<label>										<span>'.__('ZIP/Postal Code','booking').'</span>										<input id="cs_hotel_postal" name="cs_hotel_postal" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Phone #','booking').'</span>										<input id="cs_hotel_phone" name="cs_hotel_phone" type="text" />									</label>									<label>										<span>'.__('Fax','booking').'</span>										<input id="cs_hotel_fax" name="cs_hotel_fax" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Email','booking').'</span>										<input id="cs_hotel_email" name="cs_hotel_email" type="text" />									</label>									<label>										<span>'.__('Stars','booking').'</span>										<input id="cs_hotel_stars" name="cs_hotel_stars" type="text" />									</label>								</div>								<div class="hotel-input">									<label>										<span>'.__('Map','booking').'</span>										<input id="cs_hotel_maps" name="cs_hotel_maps" type="text" />									</label>									<label>										<span>'.__('Booking Email','booking').'  *(required)</span>										<input id="cs_hotel_booking_email" name="cs_hotel_booking_email" type="text" />										<p>This email use in notification for Booking</p>									</label>								</div>								<div id="add_hotel_to_btn">									<a class="hotel-action-btn price-btn" id="cs_add_hotel"  data-key="add" data-id="" type="button">'.__('Add Hotel', 'booking').'</a>								</div>							</div>							</div>						</div>';			return force_balance_tags( $cs_html, true );		}				/**		 *		 *@add New Hotel		 *		 */		public function cs_add_hotels(){			global $post,$gateways,$cs_plugin_options;						$json		= array();			$key		= $_REQUEST['key'];									if( $key == 'update' ) {				$hotel_id		= $_REQUEST['id'];			} else{				$hotel_id  = CS_FUNCTIONS()->cs_generate_random_string(10);			}						$cs_hotel_name		= $_REQUEST['cs_hotel_name'];			$cs_hotel_street_adres	= $_REQUEST['cs_hotel_street_adres'];			$cs_hotel_city		= $_REQUEST['cs_hotel_city'];			$cs_hotel_state		= $_REQUEST['cs_hotel_state'];			$cs_hotel_postal	= $_REQUEST['cs_hotel_postal'];			$cs_hotel_country	= $_REQUEST['cs_hotel_country'];			$cs_hotel_phone		= $_REQUEST['cs_hotel_phone'];			$cs_hotel_fax		= $_REQUEST['cs_hotel_fax'];			$cs_hotel_email		= $_REQUEST['cs_hotel_email'];			$cs_hotel_booking_email		= $_REQUEST['cs_hotel_booking_email'];			$cs_hotel_stars		= $_REQUEST['cs_hotel_stars'];			$cs_hotel_maps		= $_REQUEST['cs_hotel_maps'];					if( $hotel_id !='' && $cs_hotel_name 		!='' && $cs_hotel_booking_email !='' ){										$cs_new_hotel	= array();					$cs_hotel	= get_option('cs_hotel_options');										if( isset( $cs_hotel ) && ! is_array( $cs_hotel ) ) {						$cs_hotel	= array();					}										$cs_new_hotel[$hotel_id]['hotel_id']				= $hotel_id;						$cs_new_hotel[$hotel_id]['cs_hotel_name']			= $cs_hotel_name;						$cs_new_hotel[$hotel_id]['cs_hotel_street_adres']	= $cs_hotel_street_adres;						$cs_new_hotel[$hotel_id]['cs_hotel_city']			= $cs_hotel_city;						$cs_new_hotel[$hotel_id]['cs_hotel_state']			= $cs_hotel_state;						$cs_new_hotel[$hotel_id]['cs_hotel_postal']			= $cs_hotel_postal;						$cs_new_hotel[$hotel_id]['cs_hotel_country']		= $cs_hotel_country;						$cs_new_hotel[$hotel_id]['cs_hotel_fax']			= $cs_hotel_fax;						$cs_new_hotel[$hotel_id]['cs_hotel_phone']			= $cs_hotel_phone;						$cs_new_hotel[$hotel_id]['cs_hotel_email']			= $cs_hotel_email;					$cs_new_hotel[$hotel_id]['cs_hotel_booking_email']	= $cs_hotel_booking_email;					$cs_new_hotel[$hotel_id]['cs_hotel_stars']			= $cs_hotel_stars;					$cs_new_hotel[$hotel_id]['cs_hotel_maps']			= $cs_hotel_maps;											if( isset( $cs_hotel[$hotel_id]) && $key == 'add' ) {						$json['type']		= 'error';						$json['message']	= __('Hotel already exist.','booking');						echo json_encode( $json );						die();										} else if( isset( $cs_hotel[$hotel_id]) && $key == 'update' ) {												$cs_all_hotels	= 	array_merge($cs_hotel,$cs_new_hotel);						update_option( 'cs_hotel_options',$cs_all_hotels );												$json['type']		= 'success';						$json['message']	= __('Hotel Updated.','booking');						echo json_encode( $json );						die();										} else {												$cs_all_hotels	= 	array_merge($cs_hotel,$cs_new_hotel);						update_option( 'cs_hotel_options',$cs_all_hotels );												$json['data']	= '<tr class="hotel-detail">';							$json['data']	.= '<td>'.$cs_hotel_name.'</td>';							$json['data']	.= '<td>'.$cs_hotel_country.'</td>';							$json['data']	.= '<td>'.$cs_hotel_booking_email.'</td>';							$json['data']	.= '<td>'.$cs_hotel_stars.'</td>';							$json['data']	.= '<td>'.$cs_hotel_phone.'</td>';							$json['data']	.= '<td class="hotel-action" data-key="'.$hotel_id.'">													<script type="text/javascript">													jQuery(document).ready(function() {														cs_delete_hotel();													});													</script>													<a class="hotel-delete"><i class="icon-trash4"></i></a>													<a class="hotel-edit" onclick="javascript:cs_createpop(\'cs_hotel_pop_'.$hotel_id.'\',\'filter\')"><i class="icon-pencil3"></i></a>													'.$this->cs_hotel_edit($hotel_id,$hotel_id).'												</td>';						$json['data']	.= '</tr>';																		$json['type']		= 'success';						$json['message']	= __('Hotel Added.','booking');					}				} else{				$json['type']		= 'error';				$json['message']	= __('Please fill all the fields.','booking');			}						echo json_encode( $json );			die();		}				/**		 *		 *@Remove Hotel		 *		 */		public function cs_remove_hotels(){			global $post,$cs_plugin_options;						$hotel_id			= CS_FUNCTIONS()->cs_generate_random_string(10);			$json				= array();			$cs_hotels	= get_option('cs_hotel_options');			$key		= $_REQUEST['key'];								if( $key !='' ){				unset( $cs_hotels[$key] );				update_option( 'cs_hotel_options',$cs_hotels );								$json['type']		= 'success';				$json['message']	= __('Hotel Deleted.','booking');				} else{				$json['type']		= 'error';				$json['message']	= __('Please fill all the fields.','booking');			}						echo json_encode( $json );			die();		}	}		new cs_hotels_options();}